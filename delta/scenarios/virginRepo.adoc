=== Virgin repository, first time client connects

[plantuml,virginRepo,svg]
----
hide footbox
autonumber

box "Client A"
  participant Editor as editor
  participant Events as clientEvent
  participant Commands as clientCmd
  participant Queries as clientQuery
end box

box "Repository"
  participant Queries as repoQuery
  participant Commands as repoCmd
'  participant Queries  as rQry
  participant Events as repoEvent
  participant Core as core
end box

== Client A unconnected ==

clientQuery -> repoQuery ++: signOn()
return participationId = "client-a"

[->> clientCmd ++
clientCmd -> repoCmd ++: addPartition(nodeA, "cmd-1")
repoCmd ->> core
activate core
clientCmd <-- repoCmd: received("cmd-1")
deactivate clientCmd
deactivate repoCmd

core -> core: update()

core -> repoEvent
deactivate core

activate repoEvent
clientEvent <<- repoEvent: partitionAdded(nodeA, [("client-a", "cmd-1")], 1)
deactivate repoEvent

activate clientEvent
clientEvent -> editor
deactivate clientEvent

activate editor
editor -> editor: draw(nodeA)
----

1. Client <<qry-signOn, signs on>> to repository.
2. Repository confirms participation with participation id `client-a`.
3. Client initiates new partition.
4. Client sends <<cmd-addPartition>> command with `nodeA` payload (details omitted) and command id `cmd-1`.
5. Repository registers command for processing.
6. Repository acknowledges reception of command with id `cmd-1`.
7. Repository updates internal representation.
8. Repository creates event for update.
9. Repository emits event <<evnt-partitionAdded>> with `nodeA` payload and sequence number `1`.
It includes one <<commandSourceType>> with value `(client-a, cmd-1)`
10. Client receives event and forwards information to editor.
11. Client draws `nodeA`.
